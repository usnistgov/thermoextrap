

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Models for Gaussian process regression (gp_models) &#8212; thermoextrap 0.3.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="https://code.jquery.com/jquery-3.6.2.min.js"></script>
    <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
    <script src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
    <script src="../../_static/js/leave_notice.js"></script>
    <script async="async" id="_fed_au_ua_tag" type="text/javascript" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/generated/thermoextrap.gpr_active.gp_models';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="GPR utilities (active_utils)" href="thermoextrap.gpr_active.active_utils.html" />
    <link rel="prev" title="Gaussian process regression (gpr_active)" href="../api-gpr.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">thermoextrap 0.3.0 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    thermoextrap: Thermodynamic Extrapolation/Interpolation Library
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../examples/index.html">User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/usage/basic/Test_System_Ideal_Gas.html">Model system: 1D ideal gas in a linear external potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/usage/basic/Data_Organization.html">Data Organization</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/thermoextrap.html">Temperature Extrapolation/interpolation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/basic/Temperature_Extrap_Case1.html">Temperature indepent average observable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/basic/Temperature_Extrap_Case2.html">Temperature dependent average observable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/basic/Temperature_Extrap_Case3.html">Temperature independent negative logarithm of average observable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/basic/Temperature_Extrap_Case4.html">Temperature dependent negative logarithm of average observable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/basic/Temperature_Interp.html">Temperature interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/basic/Macrostate_Dist_Extrap.html">Macrostate distribution extrapolation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/usage/basic/Customized_Derivatives.html">Extrapolation in volume and custom derivatives</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../examples/gpr.html">GP Models Utilizing Derivative Information and Active Learning</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/gpr/Ideal_Gas.html">Ideal Gas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/gpr/LJ_lnPi.html">Lennard-Jones macrostate distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/usage/gpr/SWF_Adsorption.html">Active learning: adsorption of a square-well fluid in a pore</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-public.html">Top level API (<code class="xref py py-mod docutils literal notranslate"><span class="pre">thermoextrap</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermoextrap.data.html">Data handlers (<code class="xref py py-mod docutils literal notranslate"><span class="pre">data</span></code>)</a></li>







<li class="toctree-l2"><a class="reference internal" href="thermoextrap.models.html">General extrapolation/interpolation models (<code class="xref py py-mod docutils literal notranslate"><span class="pre">models</span></code>)</a></li>








<li class="toctree-l2"><a class="reference internal" href="thermoextrap.idealgas.html">Ideal gas reference (<code class="xref py py-mod docutils literal notranslate"><span class="pre">idealgas</span></code>)</a></li>


















<li class="toctree-l2"><a class="reference internal" href="thermoextrap.beta.html">Inverse temperature (beta) extrapolation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">beta</span></code>)</a></li>












<li class="toctree-l2"><a class="reference internal" href="thermoextrap.volume.html">Volume extrapolation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">volume</span></code>)</a></li>




<li class="toctree-l2"><a class="reference internal" href="thermoextrap.volume_idealgas.html">Volume expansion for ideal gas (<code class="xref py py-mod docutils literal notranslate"><span class="pre">volume_idealgas</span></code>)</a></li>




<li class="toctree-l2"><a class="reference internal" href="thermoextrap.recursive_interp.html">Recursive interpolation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">recursive_interp</span></code>)</a></li>

<li class="toctree-l2"><a class="reference internal" href="thermoextrap.adaptive_interp.html">Adaptive interpolation (<code class="xref py py-mod docutils literal notranslate"><span class="pre">adaptive_interp</span></code>)</a></li>









<li class="toctree-l2"><a class="reference internal" href="thermoextrap.lnpi.html">Inverse temperature expansion of macrostate distribution (<code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpi</span></code>)</a></li>





<li class="toctree-l2 current active has-children"><a class="reference internal" href="../api-gpr.html">Gaussian process regression (<code class="xref py py-mod docutils literal notranslate"><span class="pre">gpr_active</span></code>)</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Models for Gaussian process regression (<code class="xref py py-mod docutils literal notranslate"><span class="pre">gp_models</span></code>)</a></li>











<li class="toctree-l3"><a class="reference internal" href="thermoextrap.gpr_active.active_utils.html">GPR utilities (<code class="xref py py-mod docutils literal notranslate"><span class="pre">active_utils</span></code>)</a></li>

































<li class="toctree-l3"><a class="reference internal" href="thermoextrap.gpr_active.ig_active.html">GPR for ideal gas (<code class="xref py py-mod docutils literal notranslate"><span class="pre">ig_active</span></code>)</a></li>


</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api-baseclasses.html">Base classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../navigation.html">Indices and tables</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../genindex.html">Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../py-modindex.html">Module Index</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/usnistgov/thermoextrap" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/usnistgov/thermoextrap/issues/new?title=Issue%20on%20page%20%2Freference/generated/thermoextrap.gpr_active.gp_models.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/reference/generated/thermoextrap.gpr_active.gp_models.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Models for Gaussian process regression (gp_models)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Models for Gaussian process regression (<code class="xref py py-mod docutils literal notranslate"><span class="pre">gp_models</span></code>)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel"><code class="docutils literal notranslate"><span class="pre">DerivativeKernel</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel.ard"><code class="docutils literal notranslate"><span class="pre">DerivativeKernel.ard</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianNoiseGP"><code class="docutils literal notranslate"><span class="pre">HetGaussianNoiseGP</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.maximum_log_likelihood_objective"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.maximum_log_likelihood_objective()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_f"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.predict_f()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_y"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.predict_y()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_log_density"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.predict_log_density()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple"><code class="docutils literal notranslate"><span class="pre">HetGaussianSimple</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple.build_scaled_cov_mat"><code class="docutils literal notranslate"><span class="pre">HetGaussianSimple.build_scaled_cov_mat()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.multioutput_multivariate_normal"><code class="docutils literal notranslate"><span class="pre">multioutput_multivariate_normal()</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv"><code class="docutils literal notranslate"><span class="pre">HetGaussianDeriv</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv.build_scaled_cov_mat"><code class="docutils literal notranslate"><span class="pre">HetGaussianDeriv.build_scaled_cov_mat()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_f"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.predict_f()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_y"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.predict_y()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_log_density"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.predict_log_density()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.maximum_log_likelihood_objective"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.maximum_log_likelihood_objective()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_f"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.predict_f()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_y"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.predict_y()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_log_density"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.predict_log_density()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs"><code class="docutils literal notranslate"><span class="pre">ConstantMeanWithDerivs</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs.__call__"><code class="docutils literal notranslate"><span class="pre">ConstantMeanWithDerivs.__call__()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs"><code class="docutils literal notranslate"><span class="pre">LinearWithDerivs</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs.__call__"><code class="docutils literal notranslate"><span class="pre">LinearWithDerivs.__call__()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc"><code class="docutils literal notranslate"><span class="pre">SympyMeanFunc</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc.__call__"><code class="docutils literal notranslate"><span class="pre">SympyMeanFunc.__call__()</span></code></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <span class="target" id="module-thermoextrap.gpr_active.gp_models"></span><section id="models-for-gaussian-process-regression-gp-models">
<h1>Models for Gaussian process regression (<a class="reference internal" href="#module-thermoextrap.gpr_active.gp_models" title="thermoextrap.gpr_active.gp_models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">gp_models</span></code></a>)<a class="headerlink" href="#models-for-gaussian-process-regression-gp-models" title="Permalink to this heading">#</a></h1>
</section>
<p><strong>Classes:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel" title="thermoextrap.gpr_active.gp_models.DerivativeKernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DerivativeKernel</span></code></a>(kernel_expr, obs_dims[, ...])</p></td>
<td><p>Creates a kernel that can be differentiated based on a sympy expression for the kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HetGaussianNoiseGP" title="thermoextrap.gpr_active.gp_models.HetGaussianNoiseGP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HetGaussianNoiseGP</span></code></a>(data[, noise_kernel])</p></td>
<td><p>EXPERIMENTAL! NOT INTENDED FOR USE, BUT USEFUL FOR FUTURE WORK!</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR" title="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR</span></code></a>(data, kernel[, ...])</p></td>
<td><p>EXPERIMENTAL! NOT INTENDED FOR USE, BUT USEFUL FOR FUTURE WORK!</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple" title="thermoextrap.gpr_active.gp_models.HetGaussianSimple"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HetGaussianSimple</span></code></a>(cov[, init_scale])</p></td>
<td><p>NOTE MAINTAINED, MAY BE OUT OF DATE AND NOT COMPATIBLE.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv" title="thermoextrap.gpr_active.gp_models.HetGaussianDeriv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HetGaussianDeriv</span></code></a>(cov, d_orders[, p, s, ...])</p></td>
<td><p>Heteroscedastic Gaussian likelihood with variance provided and no modeling of noise variance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale</span></code></a>(data, kernel)</p></td>
<td><p>EXPERIMENTAL! NOT INTENDED FOR USE, BUT MAYBE INTERESTING TO CONSIDER IN FUTURE!</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HeteroscedasticGPR</span></code></a>(data, kernel[, ...])</p></td>
<td><p>Implements a GPR model with heteroscedastic input noise, which must be the full noise covariance matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs" title="thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConstantMeanWithDerivs</span></code></a>(y_data)</p></td>
<td><p>Constant mean function that takes derivative-augmented X as input.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs" title="thermoextrap.gpr_active.gp_models.LinearWithDerivs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LinearWithDerivs</span></code></a>(x_data, y_data)</p></td>
<td><p>Linear mean function that can be applied to derivative data - in other words, the 0th order derivative is fit with a linear fit, so the 1st derivative also has to be modified (by a constant that is the slope).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc" title="thermoextrap.gpr_active.gp_models.SympyMeanFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SympyMeanFunc</span></code></a>(expr, x_data, y_data[, params])</p></td>
<td><p>Mean function based on sympy expression.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.multioutput_multivariate_normal" title="thermoextrap.gpr_active.gp_models.multioutput_multivariate_normal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multioutput_multivariate_normal</span></code></a>(x, mu, L)</p></td>
<td><p>Follows gpflow.logdensities.multivariate_normal exactly, but changes reducing sums so that multiple outputs with DIFFERENT covariance matrices can be taken into account.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.DerivativeKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">DerivativeKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kernel_expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">active_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L18-L219"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/kernels/index.html#gpflow.kernels.Kernel" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Kernel</span></code></a></p>
<p>Creates a kernel that can be differentiated based on a sympy expression for
the kernel. Given observations that are tagged with the order of the
derivative, builds the appropriate kernel. Be warned that your kernel_expr
will not be checked to make sure it is positive definite, stationary, etc.</p>
<p>There are rules for kernel_expr and kernel_params that guarantee
consistency. First, the variable names supplied as keys to kernel_params
should match the symbol names in kernel_expr. Symbol names for the inputs
should be ‘x1’ and ‘x2’ (ignoring case). We could accept anything as long as
2 symbols are left over after those in kernel_params, but these two rules
will guarantee that nothing breaks.</p>
<p>Currently, everything is only intended to work with 1D observables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel_expr</strong> (<a class="reference external" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr" title="(in SymPy v1.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>) – Expression for the kernel that can be differentiated - must have at
least 2 symbols (symbol names should be ‘x1’ and ‘x2’, case insensitive,
if have only 2)</p></li>
<li><p><strong>obs_dims</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of dimensions for observable input (input should be twice this
with obs_dims values then obs_dims derivative labels each row)</p></li>
<li><p><strong>kernel_params</strong> (<a class="reference external" href="https://docs.python.org/3/glossary.html#term-mapping" title="(in Python v3.11)"><span class="xref std std-term">mapping</span></a>) – A dictionary of kernel parameters that can be optimized by tensorflow
(key should be name, then references list with value then another dict
with kwargs for gpflow.Parameter, i.e., {‘variance’, [1.0,
{‘transform’:gpflow.utilities.positive()}]} so if you don’t want to set
any kwargs, just pass empty dictionary NOTE THAT THE KEYS MUST MATCH THE
SYMBOL NAMES IN kernel_expr OTHER THAN ‘x1’ and ‘x2’ Default is empty
dict, so will mine names from kernel_expr and set all parameters to 1.0</p></li>
</ul>
</dd>
</dl>
<p><strong>Attributes:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel.ard" title="thermoextrap.gpr_active.gp_models.DerivativeKernel.ard"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ard</span></code></a></p></td>
<td><p>Whether ARD behavior is active, following gpflow.kernels.Stationary.</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.DerivativeKernel.ard">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ard</span></span><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel.ard" title="Permalink to this definition">#</a></dt>
<dd><p>Whether ARD behavior is active, following gpflow.kernels.Stationary.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HetGaussianNoiseGP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">HetGaussianNoiseGP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L222-L295"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HetGaussianNoiseGP" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/likelihoods/index.html#gpflow.likelihoods.ScalarLikelihood" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarLikelihood</span></code></a></p>
<p>EXPERIMENTAL! NOT INTENDED FOR USE, BUT USEFUL FOR FUTURE WORK!</p>
<p>Intended to model the noise associated with a GPR model using another GP contained
within the likelihood. In other words, the likelihood, which usually describes the
distribution for the added noise, is based on a GP that predicts the noise based on
a specific input location, allowing for heteroscedastic noise modeling. Typically,
you will want to actually model the logarithm of the noise variance as a function of
the input, but this likelihood is more general than that.</p>
<p>Specifically, the GP over noise is self.noise_GP, and is a standard gpflow.models.GPR
model with a kernel specified by noise_kernel. If not provided, the default kernel
used is a Matern52 with separate lengthscales over the different input dimensions.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">FullyHeteroscedasticGPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L298-L440"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPModel</span></code></a>, <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.InternalDataTrainingLossMixin" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">InternalDataTrainingLossMixin</span></code></a></p>
<p>EXPERIMENTAL! NOT INTENDED FOR USE, BUT USEFUL FOR FUTURE WORK!</p>
<p>Implements a fully heteroscedastic GPR model in which the noise is modeled
with another Gaussian Process. To accomplish this, the likelihood is set to
contain a simple GPR model that predicts the logarithm of the noise based on
noise estimates passed into the model. The full likelihood involves that of
both the outer heteroscedastic GPR using the predicted noise values and the
GP on the noise, as proposed by Binois, et al. 2018.  However, since we do
not want to model the “full N” data (i.e., all of the outputs for each sim
configuration), but instead just the means from each simulation (guaranteed
to be Gaussian by the CLT), we really follow the protocol of Ankenman et al.,
2010 but allow noise in the GP over noise so that smoothing is applied. And,
as mentioned above, both likelihoods are combined, not fit separately, as in
Binois, et al. 2018.</p>
<p>The input X data just has to match whatever kernel function is used.
For the input Y data, there must be three columns: (1) the values to model,
(2) the variance associated with each value, and (3) the number of sim frames
or configurations used to calculate the provided value and variance.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.maximum_log_likelihood_objective" title="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.maximum_log_likelihood_objective"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maximum_log_likelihood_objective</span></code></a>()</p></td>
<td><p>Objective for maximum likelihood estimation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_f" title="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_f"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_f</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_f" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_f()</span></code></a> for further details.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_y" title="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_y</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_y" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_y()</span></code></a> for further details.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_log_density" title="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_log_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_log_density</span></code></a>(data[, full_cov, ...])</p></td>
<td><p>Compute the log density of the data at the new data points.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.maximum_log_likelihood_objective">
<span class="sig-name descname"><span class="pre">maximum_log_likelihood_objective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L347-L348"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.maximum_log_likelihood_objective" title="Permalink to this definition">#</a></dt>
<dd><p>Objective for maximum likelihood estimation. Should be maximized. E.g.
log-marginal likelihood (hyperparameter likelihood) for GPR, or lower
bound to the log-marginal likelihood (ELBO) for sparse and variational
GPs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_f">
<span class="sig-name descname"><span class="pre">predict_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L373-L399"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_f" title="Permalink to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_f" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_f()</span></code></a> for further details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_y">
<span class="sig-name descname"><span class="pre">predict_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L401-L421"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_y" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_y()</span></code></a> for further details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_log_density">
<span class="sig-name descname"><span class="pre">predict_log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L423-L440"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_log_density" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the log density of the data at the new data points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HetGaussianSimple">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">HetGaussianSimple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L443-L536"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/likelihoods/index.html#gpflow.likelihoods.ScalarLikelihood" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarLikelihood</span></code></a></p>
<p>NOTE MAINTAINED, MAY BE OUT OF DATE AND NOT COMPATIBLE.</p>
<p>Heteroscedastic Gaussian likelihood with variance provided and no modeling of noise
variance. Note that the noise variance can be provided as a matrix or a 1D array.
If a 1D array, it is assumed that the off-diagonal elements of the noise covariance
matrix are all zeros, otherwise the noise covariance is used. For diagonal elements,
it would make sense to also provide this information as an additional column in the
target outputs, Y. However, this is not possible for a provided covariance matrix,
when some of the noise values may be correlated as for derivatives at the same input
location, X, measured from the same simulation. Just be careful to make sure shapes of
Y and F (predicted GP mean values) match shape of provided covariance matrix - if matrix
is NxN, each of Y and F should be N.</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple.build_scaled_cov_mat" title="thermoextrap.gpr_active.gp_models.HetGaussianSimple.build_scaled_cov_mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scaled_cov_mat</span></code></a>()</p></td>
<td><p>Creates scaled covariance matrix using noise scale parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HetGaussianSimple.build_scaled_cov_mat">
<span class="sig-name descname"><span class="pre">build_scaled_cov_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L486-L488"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple.build_scaled_cov_mat" title="Permalink to this definition">#</a></dt>
<dd><p>Creates scaled covariance matrix using noise scale parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.multioutput_multivariate_normal">
<span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">multioutput_multivariate_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L539-L589"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.multioutput_multivariate_normal" title="Permalink to this definition">#</a></dt>
<dd><p>Follows gpflow.logdensities.multivariate_normal exactly, but changes reducing sums so
that multiple outputs with DIFFERENT covariance matrices can be taken into account.
This still assumes that data in different columns of x are independent, but allows for
a different Cholesky decomposition for each column or dimension. In the code for GPflow,
everything would work if supplied x.T[…, None] was supplied with an L with leading
batch dimension of the same dimensionality as the last dimension of x, EXCEPT that the
last tf.reduce_sum over the diagonal part of L would sum over all independent matrices,
which we do not want. This could all be accomplished with a loop over dimensions and
separate applications of multivariate_normal, but hopefully this parallelizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array" title="(in NumPy v1.24)"><span class="xref std std-term">array</span></a>) – Shape <cite>N x D</cite> where here <cite>N</cite> is the number of input locations and <cite>D</cite> is
the dimensionality</p></li>
<li><p><strong>mu</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array" title="(in NumPy v1.24)"><span class="xref std std-term">array</span></a>) – Shape <cite>N x D</cite>, or broadcastable to NxD. mean values</p></li>
<li><p><strong>L</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array" title="(in NumPy v1.24)"><span class="xref std std-term">array</span></a>) – Shape <cite>DxNxN</cite> Cholesky decomposition of <cite>D</cite> independent covariance
matrices</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array" title="(in NumPy v1.24)"><span class="xref std std-term">array</span></a>) – Shape of length <cite>D</cite>. Vector of log probabilities for each dimension
(summed over input locations) Since covariance matrices independent
across dimensions but convey covariances across locations, makes sense
to sum over locations as would for multivariate Gaussian over each
dimension</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HetGaussianDeriv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">HetGaussianDeriv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_orders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p=10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s=0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_p=&lt;tfp.bijectors.Softplus</span> <span class="pre">'softplus'</span> <span class="pre">batch_shape=[]</span> <span class="pre">forward_min_event_ndims=0</span> <span class="pre">inverse_min_event_ndims=0</span> <span class="pre">dtype_x=?</span> <span class="pre">dtype_y=?&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform_s=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_p=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_s=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L592-L766"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/likelihoods/index.html#gpflow.likelihoods.ScalarLikelihood" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarLikelihood</span></code></a></p>
<p>Heteroscedastic Gaussian likelihood with variance provided and no modeling
of noise variance. Note that the noise variance can be provided as a matrix
or a 1D array. If a 1D array, it is assumed that the off-diagonal elements
of the noise covariance matrix are all zeros, otherwise the noise covariance
is used. For diagonal elements, it would make sense to also provide this
information as an additional column in the target outputs, Y. However, this
is not possible for a provided covariance matrix, when some of the noise
values may be correlated as for derivatives at the same input location, X,
measured from the same simulation. Just be careful to make sure shapes of Y
and F (predicted GP mean values) match shape of provided covariance matrix -
if matrix is NxN, each of Y and F should be N.</p>
<p>Additionally, takes derivative orders of each input point. This model by
default will scale noise differently for different derivative orders,
effectively assuming that uncertainty is likely to be estimated incorrectly
at some orders and accurately at others.</p>
<p>Won’t learn full model on noise, but can still allow scaling of it to be learned
Imagine adding parameter to indicate “trust” of given noise and scale it
So just add parameter to train that scales noise
For scaling model, effectively model logarithm of each element in covariance matrix</p>
<div class="math notranslate nohighlight">
\[\ln {\rm cov}_{i,j} = \ln {\rm cov}_{i,j,0} + p (d_i + d_j) + s\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[{\rm cov}_{i,j} = {\rm cov}_{i,j,0} \exp[ p (d_i + d_j)] \exp(s)\]</div>
<p>We can accomplish this while keeping the scaled covariance matrix positive
semidefinite by making the scaling matrix diagonal with positive entries
If we then take S*Cov*S, with S being the diagonal scaling matrix with positive
entries, the result will be positive semi-definite because S is positive definite
and Cov is positive semidefinite
The scaling matrix is given by <span class="math notranslate nohighlight">\(exp(s + p*d_i,j)\)</span> if <span class="math notranslate nohighlight">\(i=j\)</span> and 0 otherwise
While could make parameters s and p unconstrained, default will set <code class="docutils literal notranslate"><span class="pre">s=0</span></code>, <cite>p&gt;=0`</cite>.
This means that we CANNOT decrease the uncertainty, only increase it
Further, if we increase the uncertainty, we must do it MORE for higher order
derivatives
Rationale is that it’s only a really big deal if underestimate uncertainty
Further, tend to have more numerical issues, bias, etc. in derivatives
Even if derivatives actually more certain, typically want to focus on
Fitting the function itself, not the derivatives
In that case, can set p effectively to zero and will emphasize derivatives more</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array" title="(in NumPy v1.24)"><span class="xref std std-term">array</span></a>) – covariance matrix (or its diagonal) for the uncertainty (noise) in the data</p></li>
<li><p><strong>d_orders</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – derivative order of the data; should be in same order as columns/rows of
the covariance matrix</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">10.0</span></code>) – scaling of the covariance matrix dependent on derivative order</p></li>
<li><p><strong>s</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">0.0</span></code>) – scaling of the covariance matrix independent of derivative order</p></li>
<li><p><strong>transform_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>, <em>optional</em>) – Defaults to <code class="docutils literal notranslate"><span class="pre">gpflow.utilities.positive()</span></code> transformation of p during
training of the GP model; the default is to require it be positive</p></li>
<li><p><strong>transform_s</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a>, <em>optional</em>) – transformation of s during GP model training</p></li>
<li><p><strong>constrain_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>default</em> <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>) – whether or not p should be constrained and not altered during GP model
training</p></li>
<li><p><strong>constrain_s</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>default</em> <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>) – whether or not to constrain s during GP model training</p></li>
<li><p><strong>**kwargs</strong> – Extra keyword arguments passed to <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/likelihoods/index.html#gpflow.likelihoods.ScalarLikelihood" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gpflow.likelihoods.ScalarLikelihood</span></code></a></p></li>
</ul>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv.build_scaled_cov_mat" title="thermoextrap.gpr_active.gp_models.HetGaussianDeriv.build_scaled_cov_mat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scaled_cov_mat</span></code></a>()</p></td>
<td><p>Creates scaled covariance matrix using noise scale parameters.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HetGaussianDeriv.build_scaled_cov_mat">
<span class="sig-name descname"><span class="pre">build_scaled_cov_mat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L700-L718"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv.build_scaled_cov_mat" title="Permalink to this definition">#</a></dt>
<dd><p>Creates scaled covariance matrix using noise scale parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.4)"><code class="docutils literal notranslate"><span class="pre">tf.Tensor</span></code></a> – Tensor of the scaled covariance matrix</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">HeteroscedasticGPR_analytical_scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L769-L916"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPModel</span></code></a>, <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.InternalDataTrainingLossMixin" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">InternalDataTrainingLossMixin</span></code></a></p>
<p>EXPERIMENTAL! NOT INTENDED FOR USE, BUT MAYBE INTERESTING TO CONSIDER IN FUTURE!</p>
<p>Implements a GPR model with heteroscedastic input noise, which can be just a vector
(diagonal noise covariance matrix) or the full noise covariance matrix if noise is
correlated within some of the input data. The latter is useful for derivatives from
the same simulation at the same input location. The covariance matrix is expected to
be the third element of the input data tuple (X, Y, noise_cov).</p>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maximum_log_likelihood_objective</span></code></a>()</p></td>
<td><p>Objective for maximum likelihood estimation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_f" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_f"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_f</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_f" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_f()</span></code></a> for further details.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_y" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_y</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_y" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_y()</span></code></a> for further details.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_log_density" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_log_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_log_density</span></code></a>(data[, full_cov, ...])</p></td>
<td><p>Compute the log density of the data at the new data points.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective">
<span class="sig-name descname"><span class="pre">maximum_log_likelihood_objective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L830-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective" title="Permalink to this definition">#</a></dt>
<dd><p>Objective for maximum likelihood estimation. Should be maximized. E.g.
log-marginal likelihood (hyperparameter likelihood) for GPR, or lower
bound to the log-marginal likelihood (ELBO) for sparse and variational
GPs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_f">
<span class="sig-name descname"><span class="pre">predict_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L860-L895"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_f" title="Permalink to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_f" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_f()</span></code></a> for further details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_y">
<span class="sig-name descname"><span class="pre">predict_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L897-L906"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_y" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_y()</span></code></a> for further details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_log_density">
<span class="sig-name descname"><span class="pre">predict_log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L908-L916"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_log_density" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the log density of the data at the new data points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">HeteroscedasticGPR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_scale_fac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L919-L1122"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GPModel</span></code></a>, <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.InternalDataTrainingLossMixin" title="(in GPflow)"><code class="xref py py-class docutils literal notranslate"><span class="pre">InternalDataTrainingLossMixin</span></code></a></p>
<p>Implements a GPR model with heteroscedastic input noise, which must be the full noise
covariance matrix. This is necessary for derivatives from the same simulation at the
same input location, which will likely be correlated. If the output is multidimensional,
a separate covariance matrix may be specified for each dimension of the output - if this
is not the case, the same covariance matrix will be used for all output dimensions. The
consequence of this structure is that the model is independent across output dimensions,
which means that, for multidimensional output, a gpflow shared or separate independent
multioutput kernel should be used to wrap whatever kernel has been specified. If it is
detected that the kernel does not satisfy this property, the model will attempt to
appropriately wrap the specified kernel. The covariance matrix is expected to
be the third element of the input data tuple (<cite>X, Y, noise_cov</cite>). Specific shapes should be <code class="docutils literal notranslate"><span class="pre">X.shape</span> <span class="pre">==</span> <span class="pre">(N,</span> <span class="pre">2)</span></code>, <code class="docutils literal notranslate"><span class="pre">Y.shape</span> <span class="pre">==</span> <span class="pre">(N,</span> <span class="pre">D)</span></code>, <code class="docutils literal notranslate"><span class="pre">noise_cov.shape</span> <span class="pre">==</span> <span class="pre">(N,</span> <span class="pre">D,</span> <span class="pre">D)</span> <span class="pre">or</span> <span class="pre">(D,</span> <span class="pre">D)</span></code>,
where <cite>N</cite> is the number of input locations and <cite>D</cite> is the input dimensionality. Note that the
first column of <cite>X</cite> is for the locations and the second is for the derivative order of
the observation at that location, so only 1D inputs can be handled, though the output
dimension, <cite>D</cite>, is not restricted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – A list or tuple of the input locations, output data, and noise
covariance matrix, in that order</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel" title="thermoextrap.gpr_active.gp_models.DerivativeKernel"><code class="xref py py-class docutils literal notranslate"><span class="pre">DerivativeKernel</span></code></a> object) – The kernel to use; must be DerivativeKernel or compatible subclass
expecting derivative information provided in extra columns of the input
locations</p></li>
<li><p><strong>mean_function</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">callable()</span></code></a>, <em>optional</em>) – Mean function to be used (probably should be one that
handles inputs including the derivative order)</p></li>
<li><p><strong>scale_fac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">1.0</span></code>) – scaling factor on the output data; can apply to each dimension
separately if an array; helpful to ensure all output dimensions have
similar variance</p></li>
<li><p><strong>x_scale_fac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <em>default</em> <code class="docutils literal notranslate"><span class="pre">1.0</span></code>) – scaling factor on input locations; NOT USEFUL AND SOON TO BE DEPRECATED</p></li>
<li><p><strong>likelihood_kwargs, dict, optional</strong> – Dictionary of keyword arguments to pass to the HetGaussianDeriv
likelihood model used by this GP model</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.maximum_log_likelihood_objective" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.maximum_log_likelihood_objective"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maximum_log_likelihood_objective</span></code></a>()</p></td>
<td><p>Objective for maximum likelihood estimation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_f" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_f"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_f</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_f" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_f()</span></code></a> for further details.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_y" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_y"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_y</span></code></a>(Xnew[, full_cov, full_output_cov])</p></td>
<td><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_y" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_y()</span></code></a> for further details.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_log_density" title="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_log_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_log_density</span></code></a>(data[, full_cov, ...])</p></td>
<td><p>Compute the log density of the data at the new data points.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.maximum_log_likelihood_objective">
<span class="sig-name descname"><span class="pre">maximum_log_likelihood_objective</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1018-L1019"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.maximum_log_likelihood_objective" title="Permalink to this definition">#</a></dt>
<dd><p>Objective for maximum likelihood estimation. Should be maximized. E.g.
log-marginal likelihood (hyperparameter likelihood) for GPR, or lower
bound to the log-marginal likelihood (ELBO) for sparse and variational
GPs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_f">
<span class="sig-name descname"><span class="pre">predict_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1033-L1101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_f" title="Permalink to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_f" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_f()</span></code></a> for further details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_y">
<span class="sig-name descname"><span class="pre">predict_y</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Xnew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1103-L1112"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_y" title="Permalink to this definition">#</a></dt>
<dd><p>See <a class="reference external" href="https://gpflow.github.io/GPflow/develop/api/gpflow/models/index.html#gpflow.models.GPModel.predict_y" title="(in GPflow)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gpflow.models.GPModel.predict_y()</span></code></a> for further details.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_log_density">
<span class="sig-name descname"><span class="pre">predict_log_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_output_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1114-L1122"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_log_density" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the log density of the data at the new data points.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">ConstantMeanWithDerivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_data</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1125-L1146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanFunction</span></code></p>
<p>Constant mean function that takes derivative-augmented X as input.
Only applies mean function constant to zeroth order derivatives.
Because added constant, adding mean function does not change variance or derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y_data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.24)"><span class="xref std std-term">array-like</span></a>) – The data for which the mean should be taken</p>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs.__call__" title="thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(X)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1143-L1146"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs.__call__" title="Permalink to this definition">#</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.LinearWithDerivs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">LinearWithDerivs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1149-L1190"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanFunction</span></code></p>
<p>Linear mean function that can be applied to derivative data - in other words,
the 0th order derivative is fit with a linear fit, so the 1st derivative also
has to be modified (by a constant that is the slope). Currently handles y of
multiple dimensions, but scalar output only (so fits hyperplane). Columns of
y_data should be different dimensions while rows are observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.24)"><span class="xref std std-term">array-like</span></a>) – input locations of data points</p></li>
<li><p><strong>y_data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.24)"><span class="xref std std-term">array-like</span></a>) – output data to learn linear function for based on input locations</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs.__call__" title="thermoextrap.gpr_active.gp_models.LinearWithDerivs.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(X)</p></td>
<td><p>Call self as a function.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.LinearWithDerivs.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1180-L1190"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs.__call__" title="Permalink to this definition">#</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.SympyMeanFunc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">thermoextrap.gpr_active.gp_models.</span></span><span class="sig-name descname"><span class="pre">SympyMeanFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1193-L1311"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">MeanFunction</span></code></p>
<p>Mean function based on sympy expression. This way, can take derivatives up
to any order. In the provided expression, the input variable should be ‘x’
or ‘X’, otherwise this will not work. For consistency with other mean
functions, only fit based on zero-order data, rather than fitting during
training of full GP model. params is an optional dictionary specifying
starting parameter values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expr</strong> (<a class="reference external" href="https://docs.sympy.org/latest/modules/core.html#sympy.core.expr.Expr" title="(in SymPy v1.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expr</span></code></a>) – Representing the functional form of the mean function.</p></li>
<li><p><strong>x_data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.24)"><span class="xref std std-term">array-like</span></a>) – the input locations of the data</p></li>
<li><p><strong>y_data</strong> (<a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.24)"><span class="xref std std-term">array-like</span></a>) – the output values of the data to fit the mean function to</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>, <em>optional</em>) – dictionary specifying starting parameter values for the mean function;
in other words, these values will be substituted into the sympy
expression to start with</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods:</strong></p>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc.__call__" title="thermoextrap.gpr_active.gp_models.SympyMeanFunc.__call__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code></a>(X)</p></td>
<td><p>Closely follows K_diag from DerivativeKernel.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="thermoextrap.gpr_active.gp_models.SympyMeanFunc.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/usnistgov/thermoextrap/blob/main/src/thermoextrap/gpr_active/gp_models.py#L1285-L1311"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc.__call__" title="Permalink to this definition">#</a></dt>
<dd><p>Closely follows K_diag from DerivativeKernel.</p>
</dd></dl>

</dd></dl>



                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../api-gpr.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gaussian process regression (<code class="xref py py-mod docutils literal notranslate"><span class="pre">gpr_active</span></code>)</p>
      </div>
    </a>
    <a class="right-next"
       href="thermoextrap.gpr_active.active_utils.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">GPR utilities (<code class="xref py py-mod docutils literal notranslate"><span class="pre">active_utils</span></code>)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Models for Gaussian process regression (<code class="xref py py-mod docutils literal notranslate"><span class="pre">gp_models</span></code>)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel"><code class="docutils literal notranslate"><span class="pre">DerivativeKernel</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.DerivativeKernel.ard"><code class="docutils literal notranslate"><span class="pre">DerivativeKernel.ard</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianNoiseGP"><code class="docutils literal notranslate"><span class="pre">HetGaussianNoiseGP</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.maximum_log_likelihood_objective"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.maximum_log_likelihood_objective()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_f"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.predict_f()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_y"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.predict_y()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.FullyHeteroscedasticGPR.predict_log_density"><code class="docutils literal notranslate"><span class="pre">FullyHeteroscedasticGPR.predict_log_density()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple"><code class="docutils literal notranslate"><span class="pre">HetGaussianSimple</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianSimple.build_scaled_cov_mat"><code class="docutils literal notranslate"><span class="pre">HetGaussianSimple.build_scaled_cov_mat()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.multioutput_multivariate_normal"><code class="docutils literal notranslate"><span class="pre">multioutput_multivariate_normal()</span></code></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv"><code class="docutils literal notranslate"><span class="pre">HetGaussianDeriv</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HetGaussianDeriv.build_scaled_cov_mat"><code class="docutils literal notranslate"><span class="pre">HetGaussianDeriv.build_scaled_cov_mat()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.maximum_log_likelihood_objective()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_f"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.predict_f()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_y"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.predict_y()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR_analytical_scale.predict_log_density"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR_analytical_scale.predict_log_density()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.maximum_log_likelihood_objective"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.maximum_log_likelihood_objective()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_f"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.predict_f()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_y"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.predict_y()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.HeteroscedasticGPR.predict_log_density"><code class="docutils literal notranslate"><span class="pre">HeteroscedasticGPR.predict_log_density()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs"><code class="docutils literal notranslate"><span class="pre">ConstantMeanWithDerivs</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.ConstantMeanWithDerivs.__call__"><code class="docutils literal notranslate"><span class="pre">ConstantMeanWithDerivs.__call__()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs"><code class="docutils literal notranslate"><span class="pre">LinearWithDerivs</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.LinearWithDerivs.__call__"><code class="docutils literal notranslate"><span class="pre">LinearWithDerivs.__call__()</span></code></a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc"><code class="docutils literal notranslate"><span class="pre">SympyMeanFunc</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#thermoextrap.gpr_active.gp_models.SympyMeanFunc.__call__"><code class="docutils literal notranslate"><span class="pre">SympyMeanFunc.__call__()</span></code></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By William P. Krekelberg
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021, William P. Krekelberg.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 2023-05-03.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>